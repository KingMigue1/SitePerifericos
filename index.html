<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Gamer Gear Store - Periféricos para Gamers</title>
  <link rel="stylesheet" href="css/style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
  <!-- Barra de Navegação -->
  <nav class="navbar">
    <div class="nav-container">
      <a href="index.html" class="nav-logo">Gamer Gear Store</a>
      <button class="menu-toggle" onclick="toggleMenu()" aria-label="Menu">
        <i class="fas fa-bars"></i>
      </button>
      <div class="nav-links">
        <a href="index.html" class="nav-link active">
          <i class="fas fa-home"></i>
          <span>Home</span>
        </a>
        <a href="search.html" class="nav-link">
          <i class="fas fa-search"></i>
          <span>Buscar Produtos</span>
        </a>
        <a href="compare.html" class="nav-link">
          <i class="fas fa-balance-scale"></i>
          <span>Comparar</span>
        </a>
        <a href="about.html" class="nav-link">
          <i class="fas fa-info-circle"></i>
          <span>Sobre</span>
        </a>
        <a href="admin.html" class="nav-link">
          <i class="fas fa-cog"></i>
          <span>Admin</span>
        </a>
      </div>
    </div>
  </nav>
  <div class="nav-overlay" onclick="toggleMenu()"></div>
  <button class="theme-toggle" onclick="toggleTheme()" aria-label="Alternar tema">
    <i class="fas fa-moon"></i>
  </button>

  <!-- Hero Section -->
  <section class="hero">
    <div class="hero-content">
      <h1>Encontre os Melhores Periféricos para Gaming</h1>
      <p>Compare e escolha os melhores mouses, teclados, headsets e mais para sua setup</p>
      <a href="search.html" class="btn-primary">
        <i class="fas fa-search"></i>
        Buscar Produtos
      </a>
    </div>
  </section>

  <!-- Seção de Produtos -->
  <section class="products-section">
    <h2 class="section-title">Últimos Produtos</h2>
    <div class="carousel-container">
      <button class="carousel-button prev" onclick="moveCarousel(-1)" aria-label="Produto anterior">
        <i class="fas fa-chevron-left"></i>
      </button>
      <div class="carousel">
        <div class="carousel-track" id="featuredProducts">
          <!-- Os produtos serão inseridos aqui via JavaScript -->
        </div>
      </div>
      <button class="carousel-button next" onclick="moveCarousel(1)" aria-label="Próximo produto">
        <i class="fas fa-chevron-right"></i>
      </button>
    </div>
    <div class="carousel-dots" id="carouselDots">
      <!-- Os dots serão inseridos aqui via JavaScript -->
    </div>
  </section>

  <!-- Scripts -->
  <script src="js/database.js"></script>
  <script src="js/products.js"></script>
  <script src="js/theme.js"></script>
  <script src="js/initialData.js"></script>
  <script src="js/init.js"></script>
  <script>
    let currentSlide = 0;
    const slidesToShow = 3;
    let totalSlides = 0;
    let menuOpen = false;

    // Função para alternar o menu mobile
    function toggleMenu() {
      const navLinks = document.querySelector('.nav-links');
      const overlay = document.querySelector('.nav-overlay');
      const menuToggle = document.querySelector('.menu-toggle i');
      const body = document.body;
      
      menuOpen = !menuOpen;
      navLinks.classList.toggle('active');
      overlay.classList.toggle('active');
      
      // Alterna o ícone do menu
      if (menuOpen) {
        menuToggle.classList.remove('fa-bars');
        menuToggle.classList.add('fa-times');
        body.style.overflow = 'hidden'; // Previne rolagem quando menu está aberto
      } else {
        menuToggle.classList.remove('fa-times');
        menuToggle.classList.add('fa-bars');
        body.style.overflow = ''; // Restaura rolagem
      }
    }

    // Fechar menu ao clicar em um link
    document.querySelectorAll('.nav-link').forEach(link => {
      link.addEventListener('click', () => {
        if (menuOpen) {
          toggleMenu();
        }
      });
    });

    // Fechar menu ao redimensionar para desktop
    window.addEventListener('resize', () => {
      if (window.innerWidth > 768 && menuOpen) {
        toggleMenu();
      }
    });

    // Função para mover o carrossel
    function moveCarousel(direction) {
      const track = document.querySelector('.carousel-track');
      const slides = document.querySelectorAll('.carousel-slide');
      const dots = document.querySelectorAll('.carousel-dot');
      
      currentSlide = (currentSlide + direction + totalSlides) % totalSlides;
      
      // Atualiza a posição do track
      const slideWidth = slides[0].offsetWidth;
      track.style.transform = `translateX(-${currentSlide * slideWidth}px)`;
      
      // Atualiza os dots
      dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === currentSlide);
      });
    }

    // Função para criar os dots
    function createDots(count) {
      const dotsContainer = document.getElementById('carouselDots');
      dotsContainer.innerHTML = '';
      
      for (let i = 0; i < count; i++) {
        const dot = document.createElement('button');
        dot.className = `carousel-dot ${i === 0 ? 'active' : ''}`;
        dot.setAttribute('aria-label', `Ir para slide ${i + 1}`);
        dot.onclick = () => {
          currentSlide = i;
          moveCarousel(0);
        };
        dotsContainer.appendChild(dot);
      }
    }

    // Função para alternar o tema
    function toggleTheme() {
      const body = document.body;
      const themeToggle = document.querySelector('.theme-toggle');
      const themeIcon = themeToggle.querySelector('i');
      
      if (body.getAttribute('data-theme') === 'dark') {
        body.removeAttribute('data-theme');
        themeIcon.className = 'fas fa-moon';
        localStorage.setItem('theme', 'light');
      } else {
        body.setAttribute('data-theme', 'dark');
        themeIcon.className = 'fas fa-sun';
        localStorage.setItem('theme', 'dark');
      }
    }

    // Carregar produtos para o carrossel
    async function loadCarouselProducts() {
      try {
        const productsGrid = document.getElementById('featuredProducts');
        const produtos = await obterTodosProdutos();
        
        if (!produtos || produtos.length === 0) {
          console.log('Nenhum produto encontrado');
          return;
        }

        // Ordenar produtos por ID (mais recentes primeiro)
        produtos.sort((a, b) => b.id - a.id);
        
        // Pegar os 5 produtos mais recentes
        const produtosRecentes = produtos.slice(0, 5);
        totalSlides = Math.ceil(produtosRecentes.length / slidesToShow);
        
        // Criar os dots
        createDots(totalSlides);
        
        // Adicionar produtos ao carrossel
        produtosRecentes.forEach(produto => {
          const slide = document.createElement('div');
          slide.className = 'carousel-slide';
          slide.innerHTML = `
            <div class="product-card">
              <div class="product-image">
                <img src="${produto.imagem}" alt="${produto.nome}">
              </div>
              <div class="product-info">
                <h3>${produto.nome}</h3>
                <p class="product-specs">
                  ${produto.tipo === 'mouse' ? 
                    `Sensor: ${produto.especificacoes.sensor} • Peso: ${produto.especificacoes.peso}g • ${produto.especificacoes.tipo}` :
                  produto.tipo === 'teclado' ?
                    `Switch: ${produto.especificacoes.switch} • ${produto.especificacoes.iluminacao} • ${produto.especificacoes.tipo}` :
                  produto.tipo === 'headset' ?
                    `Driver: ${produto.especificacoes.driver} • ${produto.especificacoes.microfone} • ${produto.especificacoes.tipo}` :
                  produto.tipo === 'mousepad' ?
                    `Tamanho: ${produto.especificacoes.tamanho} • Material: ${produto.especificacoes.material} • ${produto.especificacoes.tipo}` :
                  produto.tipo === 'monitor' ?
                    `Tamanho: ${produto.especificacoes.tamanho} • Resolução: ${produto.especificacoes.resolucao} • ${produto.especificacoes.taxaAtualizacao}` :
                  produto.tipo === 'webcam' ?
                    `Resolução: ${produto.especificacoes.resolucao} • FPS: ${produto.especificacoes.fps} • ${produto.especificacoes.microfone}` :
                    ''}
                </p>
                <div class="product-price">R$ ${produto.preco.toFixed(2)}</div>
                <div class="product-buttons">
                  <button class="btn-compare" onclick="window.location.href='compare.html'">
                    <i class="fas fa-balance-scale"></i>
                    Comparar
                  </button>
                  <a href="${produto.urlProduto}" class="btn-shop" target="_blank">
                    <i class="fas fa-shopping-cart"></i>
                    Ver na loja
                  </a>
                </div>
              </div>
            </div>
          `;
          productsGrid.appendChild(slide);
        });

        // Iniciar autoplay
        setInterval(() => moveCarousel(1), 5000);

      } catch (error) {
        console.error('Erro ao carregar produtos:', error);
      }
    }

    // Carregar produtos quando a página carregar
    document.addEventListener('DOMContentLoaded', loadCarouselProducts);
  </script>
</body>
</html>

